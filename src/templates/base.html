<!DOCTYPE html>
{% load static %}
<html lang="ru">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description"
        content="Marais - уникальные, концептуальные украшения, тщательно собранные из разных стран.">
    <meta name="keywords" content="украшения, концептуальные украшения, Marais, модные украшения, уникальные украшения">
    <meta name="author" content="Marais">
    <link rel="icon" href="{% static 'images/favicon.ico' %}" type="image/x-icon">
    <link rel="shortcut icon" href="{% static 'images/light_logo.png' %}" type="image/x-icon">
    <title>{% block title %}Marais{% endblock %}</title>
    <!-- Preload fonts (woff2 for best performance) -->
    <link rel="preload" href="{% static 'fonts/Jost-VariableFont_wght.woff2' %}" as="font" type="font/woff2"
        crossorigin>
    <link rel="preload" href="{% static 'fonts/Jost-Italic-VariableFont_wght.woff2' %}" as="font" type="font/woff2"
        crossorigin>

    <!-- Bootstrap CSS (CDN) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Project CSS -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <!-- Header & Footer split styles -->
    <link rel="stylesheet" href="{% static 'css/header.css' %}">
    <link rel="stylesheet" href="{% static 'css/footer.css' %}">
    {% block head %}{% endblock %}
</head>

<body>
    {% include 'includes/header.html' %}

    <main class="container-fluid p-0 flex-grow-1" role="main">
        {% block content %}{% endblock %}
    </main>

    {% include 'includes/footer.html' %}

    <!-- Bootstrap JS (CDN) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{% static 'js/main.js' %}"></script>
    {% block scripts %}{% endblock %}
    <!-- Search Modal -->
    <div class="search-modal-backdrop" data-search-backdrop></div>
    <div class="search-modal" data-search-modal>
        <button class="search-modal-close" data-search-close>&times;</button>
        <div class="search-modal-content">
            <input type="text" class="search-input" placeholder="Поиск по каталогу..." data-search-input>
            <div class="search-results" data-search-results></div>
        </div>
    </div>

    <style>
        .search-modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1040;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .search-modal-backdrop.is-visible {
            opacity: 1;
            pointer-events: auto;
        }

        .search-modal {
            position: fixed;
            top: 0;
            right: 0;
            width: 100%;
            max-width: 400px;
            height: 100%;
            background: #fff;
            z-index: 1050;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .search-modal.is-visible {
            transform: translateX(0);
        }

        .search-modal-close {
            align-self: flex-end;
            background: none;
            border: none;
            font-size: 32px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .search-input {
            width: 100%;
            padding: 12px 0;
            border: none;
            border-bottom: 1px solid #ddd;
            font-size: 18px;
            outline: none;
            margin-bottom: 20px;
        }

        .search-input:focus {
            border-bottom-color: #a71930;
        }

        .search-results {
            flex: 1;
            overflow-y: auto;
        }

        .search-result-item {
            display: flex;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid #f0f0f0;
            text-decoration: none;
            color: inherit;
        }

        .search-result-item:hover {
            background-color: #f9f9f9;
        }

        .search-item-thumb {
            width: 50px;
            height: 50px;
            border-radius: 4px;
        }

        .search-item-info {
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .search-item-title {
            font-size: 14px;
            font-weight: 500;
        }

        .search-item-price {
            font-size: 13px;
            color: #666;
        }
    </style>

    {% if cart_total_quantity > 0 and request.resolver_match.app_name != 'basket' %}
    <a href="{% url 'basket:detail' %}" class="floating-cart">
        <span class="floating-cart__icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M9 20C9 21.1046 8.10457 22 7 22C5.89543 22 5 21.1046 5 20C5 18.8954 5.89543 18 7 18C8.10457 18 9 18.8954 9 20Z"
                    fill="white" />
                <path
                    d="M20 20C20 21.1046 19.1046 22 18 22C16.8954 22 16 21.1046 16 20C16 18.8954 16.8954 18 18 18C19.1046 18 20 18.8954 20 20Z"
                    fill="white" />
                <path
                    d="M1 1H4L6.68 14.39C6.77144 14.8504 7.02191 15.264 7.3917 15.5583C7.76149 15.8526 8.22583 16.0087 8.695 16H19.4C19.8692 16.0087 20.3335 15.8526 20.7033 15.5583C21.0731 15.264 21.3236 14.8504 21.415 14.39L23 6H6"
                    stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
        </span>
        <span class="floating-cart__badge">{{ cart_total_quantity }}</span>
    </a>
    <style>
        .floating-cart {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: #a71930;
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.3s ease;
        }

        .floating-cart:hover {
            transform: scale(1.1);
        }

        .floating-cart__badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: #c9a35e;
            /* Gold color for contrast, or red if requested specifically, but button is red so gold is better */
            color: white;
            font-size: 12px;
            font-weight: bold;
            min-width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid #fff;
        }
    </style>
    {% endif %}
</body>

</html>